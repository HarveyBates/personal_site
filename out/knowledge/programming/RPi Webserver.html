<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><title>Raspberry Pi Web-Server</title><link rel="stylesheet" href="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.3.2/build/styles/default.min.css"/><meta name="next-head-count" content="4"/><link rel="preload" href="/_next/static/css/a59da0eacbea689829ee.css" as="style"/><link rel="stylesheet" href="/_next/static/css/a59da0eacbea689829ee.css" data-n-g=""/><link rel="preload" href="/_next/static/css/87c8624d19ac042a1b3c.css" as="style"/><link rel="stylesheet" href="/_next/static/css/87c8624d19ac042a1b3c.css" data-n-p=""/><noscript data-n-css=""></noscript><link rel="preload" href="/_next/static/chunks/webpack-189c53927ffd3caf09c3.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework-64eb7138163e04c228e4.js" as="script"/><link rel="preload" href="/_next/static/chunks/main-71948af4b0f09c0fc30e.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/_app-ecab9d88465f23b4ce52.js" as="script"/><link rel="preload" href="/_next/static/chunks/25-2f766847420a3f7b9c8d.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/knowledge/programming/%5Bprogramming%5D-78b343a6467ff2c4be67.js" as="script"/></head><body><div id="__next"><div><div><div class="Navbar_header__G42YY"><div class="Navbar_titleName__1SzAf"><a href="/knowledge/programming/RPi%20Webserver#">Harvey Bates</a></div><div class="Navbar_navbar__Nhtc0"><a href="/knowledge/programming/RPi%20Webserver#">Home</a><a href="/knowledge/programming/RPi%20Webserver#">About</a><a href="/knowledge/programming/RPi%20Webserver#">Blog</a><a href="/knowledge/programming/RPi%20Webserver#">Knowledge</a><a href="/knowledge/programming/RPi%20Webserver#">Publications</a></div></div></div><div><main><div><div class="Knowledge_page__2flRE"><div><h2 id="description">Description</h2>
<p>Information for setting up a secure (https) webserver using a raspberry pi, nginx, certbot and a DNS provider. Based on a tutoiral from Luke Smith; however, in this version, a Raspberry Pi was used to host the site instead of a cloud service provider such as Amazon. Other good resources include this video from Fireship, which talks about the deployment of a website on a Raspberry Pi.</p>
<h2 id="proxy-server-nginx">Proxy Server (nginx)</h2>
<ul>
<li>Reverse proxy server (TCP/UDP)</li>
<li>Documentation: <a href="https://nginx.org/en/">nginx</a></li>
<li>Tutorial: <a href="https://pimylifeup.com/raspberry-pi-nginx/">PiMyLifeUp</a></li>
</ul>
<h3 id="installation">Installation</h3>
<pre><code class="language-bash">sudo apt-get remove apache2 # Ensure apache2 in not installed
sudo apt-get install nginx # Install
</code></pre>
<h3 id="setup">Setup</h3>
<p>Copy the default nginx configuration to a new configuration:</p>
<pre><code class="language-bash">cp /etc/nginx/sites-available/default /etc/nginx/sites-available/your_site_name # Replace your_site_name
</code></pre>
<p>Edit the newly created file (/etc/nginx/sites-available/your_site_name) to display the following</p>
<pre><code class="language-bash">server {
    listen 80;
    listen [::]:80 ;

    root /var/www/*website_file_dir*;

    index index.html index.htm index.nginx-debian.html;
    
    server_name *your_website_address*;

    location / {
        if ($request_uri ~ ^/(.*)\.html) {
            return 302 /$1;
        }
        try_files $uri $uri.html $uri/ =404;
    }
</code></pre>
<p>The code in the location scope allow html files to be indexed without a .html extension in the websites URL.</p>
<p>Put newley created configuration into enabled sites directory:</p>
<pre><code class="language-bash">ln -s /etc/nginx/sites-available/your_site_name /etc/nginx/sites-enabled/
</code></pre>
<p>Make directory that holds website files (index.html etc.):</p>
<pre><code class="language-bash">mkdir /var/www/your_site_name
cd /var/www/your_site_name
touch index.html # Create and edit mainpage as needed
</code></pre>
<h3 id="nginx-commands">nginx Commands</h3>
<pre><code class="language-bash">sudo systemctl start nginx # Start server
sudo systemctl status nginx # Server status
sudo systemctl stop nginx # Stop server
sudo systemctl restart nginx # Reboot server
sudo killall nginx # Stop all processes
</code></pre>
<h2 id="https-certificate-certbot">HTTPS Certificate (certbot)</h2>
<p>Gives your website a certificate of security that browsers can recognise and thus wont show that the site is insecure.</p>
<h3 id="installation-1">Installation</h3>
<pre><code class="language-bash">sudo apt-get install certbo python-certbot-nginx
</code></pre>
<h3 id="setup-1">Setup</h3>
<pre><code class="language-bash">sudo certbot --nginx
</code></pre>
<p>Follow the following commands:</p>
<ol>
<li>Enter email</li>
<li>Agree to terms of service</li>
<li>Don&#39;t share email</li>
<li>Select https addresses</li>
<li>Redirect http to https</li>
</ol>
<p>Note that certbot certificates expire every six months. To renew:</p>
<pre><code class="language-bash">sudo certbot renew # Renew certificate
</code></pre>
<h2 id="port-forwarding">Port Forwarding</h2>
<p>You need to setup port forwarding on your router in order for users outside your local network to access your site.</p>
<pre><code class="language-bash">ip route # Find router address
</code></pre>
<p>Type the router address into a browser, navigate to port forwarding and add:</p>
<ul>
<li>Protocol: TCP</li>
<li>WAN port: 80</li>
<li>LAN port: 80</li>
<li>Destination IP address: local_ip_address</li>
</ul>
<p>You may also need to set (port 80 for http and 443 for https):</p>
<ul>
<li>Protocol: TCP</li>
<li>WAN port: 443</li>
<li>LAN port: 443</li>
<li>Destination IP address: local_ip_address</li>
</ul>
<h2 id="other-useful-commands">Other Useful Commands</h2>
<pre><code class="language-bash">hostname -I # Get local IP address
curl icanhazip.com # Get public IPv6 address
curl ipv4.icanhazip.com # Get public IPv4 address
</code></pre>
</div></div></div></main></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"htmlString":"\u003ch2 id=\"description\"\u003eDescription\u003c/h2\u003e\n\u003cp\u003eInformation for setting up a secure (https) webserver using a raspberry pi, nginx, certbot and a DNS provider. Based on a tutoiral from Luke Smith; however, in this version, a Raspberry Pi was used to host the site instead of a cloud service provider such as Amazon. Other good resources include this video from Fireship, which talks about the deployment of a website on a Raspberry Pi.\u003c/p\u003e\n\u003ch2 id=\"proxy-server-nginx\"\u003eProxy Server (nginx)\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eReverse proxy server (TCP/UDP)\u003c/li\u003e\n\u003cli\u003eDocumentation: \u003ca href=\"https://nginx.org/en/\"\u003enginx\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003eTutorial: \u003ca href=\"https://pimylifeup.com/raspberry-pi-nginx/\"\u003ePiMyLifeUp\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"installation\"\u003eInstallation\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"language-bash\"\u003esudo apt-get remove apache2 # Ensure apache2 in not installed\nsudo apt-get install nginx # Install\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"setup\"\u003eSetup\u003c/h3\u003e\n\u003cp\u003eCopy the default nginx configuration to a new configuration:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-bash\"\u003ecp /etc/nginx/sites-available/default /etc/nginx/sites-available/your_site_name # Replace your_site_name\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eEdit the newly created file (/etc/nginx/sites-available/your_site_name) to display the following\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-bash\"\u003eserver {\n    listen 80;\n    listen [::]:80 ;\n\n    root /var/www/*website_file_dir*;\n\n    index index.html index.htm index.nginx-debian.html;\n    \n    server_name *your_website_address*;\n\n    location / {\n        if ($request_uri ~ ^/(.*)\\.html) {\n            return 302 /$1;\n        }\n        try_files $uri $uri.html $uri/ =404;\n    }\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThe code in the location scope allow html files to be indexed without a .html extension in the websites URL.\u003c/p\u003e\n\u003cp\u003ePut newley created configuration into enabled sites directory:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-bash\"\u003eln -s /etc/nginx/sites-available/your_site_name /etc/nginx/sites-enabled/\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eMake directory that holds website files (index.html etc.):\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-bash\"\u003emkdir /var/www/your_site_name\ncd /var/www/your_site_name\ntouch index.html # Create and edit mainpage as needed\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"nginx-commands\"\u003enginx Commands\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"language-bash\"\u003esudo systemctl start nginx # Start server\nsudo systemctl status nginx # Server status\nsudo systemctl stop nginx # Stop server\nsudo systemctl restart nginx # Reboot server\nsudo killall nginx # Stop all processes\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"https-certificate-certbot\"\u003eHTTPS Certificate (certbot)\u003c/h2\u003e\n\u003cp\u003eGives your website a certificate of security that browsers can recognise and thus wont show that the site is insecure.\u003c/p\u003e\n\u003ch3 id=\"installation-1\"\u003eInstallation\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"language-bash\"\u003esudo apt-get install certbo python-certbot-nginx\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"setup-1\"\u003eSetup\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"language-bash\"\u003esudo certbot --nginx\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eFollow the following commands:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eEnter email\u003c/li\u003e\n\u003cli\u003eAgree to terms of service\u003c/li\u003e\n\u003cli\u003eDon\u0026#39;t share email\u003c/li\u003e\n\u003cli\u003eSelect https addresses\u003c/li\u003e\n\u003cli\u003eRedirect http to https\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eNote that certbot certificates expire every six months. To renew:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-bash\"\u003esudo certbot renew # Renew certificate\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"port-forwarding\"\u003ePort Forwarding\u003c/h2\u003e\n\u003cp\u003eYou need to setup port forwarding on your router in order for users outside your local network to access your site.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-bash\"\u003eip route # Find router address\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eType the router address into a browser, navigate to port forwarding and add:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eProtocol: TCP\u003c/li\u003e\n\u003cli\u003eWAN port: 80\u003c/li\u003e\n\u003cli\u003eLAN port: 80\u003c/li\u003e\n\u003cli\u003eDestination IP address: local_ip_address\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eYou may also need to set (port 80 for http and 443 for https):\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eProtocol: TCP\u003c/li\u003e\n\u003cli\u003eWAN port: 443\u003c/li\u003e\n\u003cli\u003eLAN port: 443\u003c/li\u003e\n\u003cli\u003eDestination IP address: local_ip_address\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"other-useful-commands\"\u003eOther Useful Commands\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"language-bash\"\u003ehostname -I # Get local IP address\ncurl icanhazip.com # Get public IPv6 address\ncurl ipv4.icanhazip.com # Get public IPv4 address\n\u003c/code\u003e\u003c/pre\u003e\n","data":{"title":"Raspberry Pi Web-Server"}},"__N_SSG":true},"page":"/knowledge/programming/[programming]","query":{"programming":"RPi Webserver"},"buildId":"-ivy6eWUB8p0P6rt7VF27","isFallback":false,"gsp":true}</script><script nomodule="" src="/_next/static/chunks/polyfills-eef578260fd80f8fff94.js"></script><script src="/_next/static/chunks/webpack-189c53927ffd3caf09c3.js" async=""></script><script src="/_next/static/chunks/framework-64eb7138163e04c228e4.js" async=""></script><script src="/_next/static/chunks/main-71948af4b0f09c0fc30e.js" async=""></script><script src="/_next/static/chunks/pages/_app-ecab9d88465f23b4ce52.js" async=""></script><script src="/_next/static/chunks/25-2f766847420a3f7b9c8d.js" async=""></script><script src="/_next/static/chunks/pages/knowledge/programming/%5Bprogramming%5D-78b343a6467ff2c4be67.js" async=""></script><script src="/_next/static/-ivy6eWUB8p0P6rt7VF27/_buildManifest.js" async=""></script><script src="/_next/static/-ivy6eWUB8p0P6rt7VF27/_ssgManifest.js" async=""></script></body></html>